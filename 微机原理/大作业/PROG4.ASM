NAME PROG4

STACK	SEGMENT STACK
	STA	DB 50 DUP (?)
	TOP	EQU LENGTH STA
STACK	ENDS

DATA	SEGMENT
	MESS	DB	'WHAT IS THE DATE( MM / DD /YY)?',0DH,0AH,'$'
	STATE 	DB	'(YY-MM-DD)',0DH,0AH,'$'
	ERROR	DB	'INPUT ERROR !',0DH,0AH,'$'
DATA	ENDS

CODE	SEGMENT
	ASSUME	CS:CODE,DS:DATA,ES:DATA,SS:STACK
	
START:	
	MOV	AX,DATA
	MOV	DS,AX
	MOV	ES,AX
	MOV	SP,TOP	;初始化
	MOV	AH,09H
	MOV	DX,OFFSET MESS
	INT	21H	;显示提示信息
	MOV AH,02H
	MOV DL,07H
	INT 21H;响铃
	CALL GETNUM
	PUSH AX
	CALL GETNUM
	PUSH AX
	CALL GETNUM	;接收键入的月、日及年值
	CALL DISP	;显示年值
	MOV	AH,02H
	MOV	DL,'-'
	INT	21H	;显示'-'
	POP	BX
	POP AX
	PUSH BX
	CALL DISP	;显示月值
	MOV	AH,02H
	MOV	DL,'-'
	INT	21H	;显示'-'
	POP AX
	CALL DISP	;显示日值
	MOV AH,09H
	MOV DX,OFFSET STATE
	INT 21H
	MOV	AX,4C00H
	INT	21H	;返回DOS
	
DISP	PROC	NEAR;现实函数，先输出DL，再输出DH
	MOV DX,AX
	MOV AH,02H
	INT 21H
	MOV DL,DH
	INT 21H
	RET
DISP	ENDP

GETNUM	PROC	NEAR
GETFIR: 
	MOV AH,08H
	INT 21H
	CMP AL,'0'
	JB GETFIR
	CMP AL,'9'
	JA GETFIR;如果超出0-9的范围，就反复要求用户输入
	PUSH AX
	MOV DL,AL
	MOV AH,02H
	INT 21H;手动回显
GETSEC:
	MOV AH,08H
	INT 21H
	CMP AL,0DH
	JZ GETSIG;如果输入回车，则表示只输入一个数字
	CMP AL,'0'
	JB GETSEC
	CMP AL,'9'
	JA GETSEC;反复输入
	PUSH AX
	MOV DL,AL
	MOV AH,02H
	INT 21H
	MOV DL,0DH
	INT 21H;回显并换行
	POP BX
	POP AX
	MOV AH,BL
	RET
GETSIG:
	MOV DL,0DH
	MOV AH,02H
	INT 21H
	POP AX
	MOV AH,AL
	MOV AL,30H;将低位补为'0'
	RET
GETNUM	ENDP

CODE	ENDS

END	START
